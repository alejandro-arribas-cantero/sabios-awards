<!DOCTYPE html>
{% load static %}
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Sabios Awards{% endblock %}</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{% static 'css/gala.css' %}" rel="stylesheet">
    <!-- Toastify CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <!-- Countdown Overlay -->
    <style>
        #launch-countdown-overlay {
            position: fixed;
            inset: 0;
            width: 100vw;
            height: 100vh;
            z-index: 2147483647;
            background-color: #0f172a;
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
            color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            text-align: center;
            overflow: hidden;
        }

        .countdown-content {
            position: relative;
            z-index: 10;
        }

        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 1rem;
        }

        .countdown-number {
            font-size: 5rem;
            font-weight: 700;
            background: linear-gradient(to bottom, #FFD700, #FDB931);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            font-family: 'Playfair Display', serif;
            text-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .countdown-label {
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 0.5rem;
            opacity: 0.8;
            font-family: 'Inter', sans-serif;
        }

        .glow-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 60%);
            pointer-events: none;
            z-index: 1;
        }

        /* Bubble Animation */
        .bubble-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .bubble {
            position: absolute;
            bottom: -150px;
            border-radius: 50%;
            opacity: 0;
            animation: rise var(--duration) linear infinite;
            left: var(--left);
            width: var(--size);
            height: var(--size);
            object-fit: cover;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        @keyframes rise {
            0% {
                transform: translateY(0) scale(1);
                opacity: 0;
            }

            10% {
                opacity: 0.7;
            }

            90% {
                opacity: 0.7;
            }

            100% {
                transform: translateY(-120vh) scale(1.1);
                opacity: 0;
            }
        }
    </style>

    <div id="launch-countdown-overlay">
        <div class="glow-effect"></div>
        <div id="bubble-container" class="bubble-container"></div>

        <div class="countdown-content">
            <h1 class="display-4 fw-bold mb-5" style="font-family: 'Playfair Display', serif; letter-spacing: 2px;">EL
                SHOW
                COMIENZA EN</h1>
            <div id="countdown-timer" class="d-flex flex-wrap justify-content-center"></div>
        </div>
    </div>

    <script>
        (function () {
            // Bubble Configuration
            const bubbleImages = [
                "v1765368041/deLorenzo_iz7ltj.png", "v1765368037/larena_nj1vlg.png", "v1765368036/david_pabjfy.png",
                "v1765368035/illan_qbf4pc.png", "v1765368032/miguel_keuohh.png", "v1765368030/pedro_qw699h.png",
                "v1765368029/ponce_zsqei6.png", "v1765368027/touza_c6u9ha.png", "v1765368026/ivanFran_adfppu.png",
                "v1765368023/diego_kgcukz.png", "v1765368022/mario_powmqq.png", "v1765368022/arribas_fkcaoj.png"
            ];
            const cloudName = "dpqalrq6d"; // Extracted from existing code if available or assumed
            const baseUrl = `https://res.cloudinary.com/${cloudName}/image/upload/`;

            function createBubble() {
                const container = document.getElementById('bubble-container');
                const overlay = document.getElementById('launch-countdown-overlay');

                // Stop creating bubbles if overlay is hidden or gone
                if (!container || !overlay || overlay.style.display === 'none') return;

                const imgId = bubbleImages[Math.floor(Math.random() * bubbleImages.length)];
                const img = document.createElement('img');
                img.src = `${baseUrl}${imgId}`;
                img.classList.add('bubble');

                // Randomize properties
                const size = Math.random() * 80 + 40; // 40px to 120px
                const left = Math.random() * 90 + 5; // 5% to 95%
                const duration = Math.random() * 10 + 10; // 10s to 20s speed
                const delay = Math.random() * 5; // 0 to 5s delay for stagger

                img.style.setProperty('--size', `${size}px`);
                img.style.setProperty('--left', `${left}%`);
                img.style.setProperty('--duration', `${duration}s`);

                container.appendChild(img);

                // Auto remove after animation completes (plus buffer)
                setTimeout(() => {
                    if (img.parentNode) img.parentNode.removeChild(img);
                }, (duration + 1) * 1000);
            }

            // Start bubble loop inside the IIFE
            // Generate initial batch
            for (let i = 0; i < 10; i++) {
                setTimeout(createBubble, i * 500);
            }
            // Continuous generation
            setInterval(createBubble, 1500);


            // Cambio de la fecha objeti                                                                    vo
            const targetDate = new Date('2025-12-10T15:28:00+01:00').getTime();
            const overlay = document.getElementById('launch-countdown-overlay');
            const timerContainer = document.getElementById('countdown-timer');

            function updateCountdown() {
                const now = new Date().getTime();
                const distance = targetDate - now;

                if (distance < 0) {
                    overlay.style.display = 'none';
                    return;
                }

                // Calculate time units
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                let html = '';

                if (days > 0) {
                    html += `<div class="countdown-item"><span class="countdown-number">${days}</span><span class="countdown-label">D√≠as</span></div>`;
                }
                if (hours > 0 || days > 0) {
                    html += `<div class="countdown-item"><span class="countdown-number">${hours.toString().padStart(2, '0')}</span><span class="countdown-label">Horas</span></div>`;
                }

                html += `
                    <div class="countdown-item">
                        <span class="countdown-number">${minutes.toString().padStart(2, '0')}</span>
                        <span class="countdown-label">Minutos</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${seconds.toString().padStart(2, '0')}</span>
                        <span class="countdown-label">Segundos</span>
                    </div>
                `;

                timerContainer.innerHTML = html;
            }

            // Initial check to avoid block if passed
            const now = new Date().getTime();
            if (targetDate - now < 0) {
                overlay.style.display = 'none';
            } else {
                // If future, ensure body overflow is hidden (optional, but handled by overlay being fixed cover)
                // We keep scroll enabled but overlay covers it. Or we can disable scroll.
                // document.body.style.overflow = 'hidden'; 
                updateCountdown();
                setInterval(updateCountdown, 1000);
            }
        })();
    </script>
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="{% url 'dashboard' %}">Sabios <span>Awards</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link fw-bold text-warning" href="{% url 'hall_of_fame' %}">üèÜ Sal√≥n de la Fama</a>
                    </li>
                    {% if user.is_authenticated %}
                    <li class="nav-item">
                        <span class="nav-link text-muted">Hola, {{ user.username }}</span>
                    </li>
                    {% if user.is_staff %}
                    <li class="nav-item">
                        <a class="nav-link text-danger fw-bold" href="{% url 'admin_dashboard' %}">Admin Panel</a>
                    </li>
                    {% endif %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'logout' %}">Salir</a>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'login' %}">Entrar</a>
                    </li>

                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        {% block content %}{% endblock %}
    </div>

    <footer class="text-center py-4 text-muted mt-5">
        <small>&copy; {% now "Y" %} Sabios Awards. Todos los derechos reservados.</small>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Toastify JS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            {% if messages %}
            {% for message in messages %}
            // Map Django tags to colors
            let bg = "linear-gradient(to right, #4b6cb7, #182848)"; // Default/Info

            {% if message.tags == 'success' %}
            bg = "linear-gradient(to right, #00b09b, #96c93d)";
            {% elif message.tags == 'error' or message.tags == 'danger' %}
            bg = "linear-gradient(to right, #ff5f6d, #ffc371)";
            {% elif message.tags == 'warning' %}
            bg = "linear-gradient(to right, #f6d365, #fda085)";
            {% endif %}

            Toastify({
                text: "{{ message|escapejs }}",
                duration: 4000,
                close: true,
                gravity: "top",
                position: "right",
                stopOnFocus: true,
                style: {
                    background: bg,
                    boxShadow: "0 4px 15px rgba(0, 0, 0, 0.2)",
                    borderRadius: "10px",
                    fontFamily: "'Inter', sans-serif",
                    fontWeight: "600",
                },
                onClick: function () { } // Callback after click
            }).showToast();
            {% endfor %}
            {% endif %}
        });
    </script>



    {% block extra_js %}{% endblock %}
</body>

</html>